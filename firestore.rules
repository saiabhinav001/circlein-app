rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // TEMPORARY: Open rules for debugging - WILL SECURE AFTER TESTING
    // Since NextAuth doesn't integrate with Firebase Auth by default,
    // we need to allow authenticated client-side operations
    
    // Communities collection
    match /communities/{communityId} {
      allow read, write: if true;
    }
    
    // Invites collection
    match /invites/{inviteId} {
      allow read, write: if true;
    }
    
    // Users collection
    match /users/{userId} {
      allow read, write: if true;
    }
    
    // Amenities collection
    match /amenities/{amenityId} {
      allow read, write: if true;
    }
    
    // Bookings collection
    match /bookings/{bookingId} {
      allow read, write: if true;
    }
    
    // Access codes collection
    match /accessCodes/{codeId} {
      allow read, write: if true;
    }
    
    // Settings collection
    match /settings/{settingId} {
      allow read, write: if true;
    }
    
    // QR Codes collection
    match /qr-codes/{qrCodeId} {
      allow read, write: if true;
    }
    
    // Notifications collection
    match /community-notifications/{notificationId} {
      allow read, write: if true;
    }
    
    // Mail collection (for Firebase Email Extension)
    match /mail/{emailId} {
      allow create: if true; // Allow anyone to create emails
      allow read, update, delete: if false; // Only backend can read/update/delete
    }
  }
}
